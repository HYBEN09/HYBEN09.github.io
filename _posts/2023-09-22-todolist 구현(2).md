---
title: TodoList κµ¬ν„ν•΄λ³΄κΈ° (3) - API νΈμ¶
author: hyebeen
date: 2023-09-22 15:52:00 +0800
categories: [React, TodoList]
tags: [react]
---

# π“ APIλ¥Ό νΈμ¶ & μ‘λ‹µ μ²λ¦¬μ— μ‚¬μ©ν•  μ μλ” HTTP κµ¬ν„

## HttpClientImpl ν΄λμ¤

```js
//* httpClient interface
//* fetch (endPoints, options):Promise<Response>

export class HttpClientImpl {
  #baseURL;
  #storage;

  constructor(baseURL, storage) {
    this.#baseURL = baseURL;
    this.#storage = storage;
  }

  async fetch(endPoint, options = {}) {
    const response = await window.fetch(this.#baseURL + endPoint, {
      ...options,
      headers: {
        "Content-Type": "application/json",
        Authorization: "Bearer " + this.#storage.get(),
        ...options.headers
      }
    });

    if (response.ok) {
      return response;
    } else {
      const errorResponse = await response.json();
      throw new Error(
        `β›”οΈ HTTP Error ${response.status}: ${errorResponse.message}`
      );
    }
  }
}
```

## 1. ν΄λμ¤ μ •μ

HttpClientImpl ν΄λμ¤λ” HTTP μ”μ²­μ„ μ²λ¦¬ν•λ” λ° μ‚¬μ©.
μƒμ„±μμ—μ„ κΈ°λ³Έ URLκ³Ό μ¤ν† λ¦¬μ§€ κ°μ²΄λ¥Ό λ°›μ•„ μ΄κΈ°ν™”.

```js
  constructor(baseURL, storage) {
  this.#baseURL = baseURL;
  this.#storage = storage;
  }
```

- baseURL: κΈ°λ³Έ URLλ΅ λ¨λ“  μ—”λ“ν¬μΈνΈλ” μ΄ URLμ„ κΈ°λ°μΌλ΅ μ‘μ„±λ©λ‹λ‹¤.
- storage: μΈμ¦ ν† ν°μ„ μ €μ¥ν•κ³  κ²€μƒ‰ν•κΈ° μ„ν• μ¤ν† λ¦¬μ§€ κ°μ²΄μ…λ‹λ‹¤.

## 2. fetch λ©”μ„λ“

fetch λ©”μ„λ“λ” μ£Όμ–΄μ§„ μ—”λ“ν¬μΈνΈλ΅ HTTP μ”μ²­μ„ λ³΄λ‚΄κ³  μ‘λ‹µμ„ μ²λ¦¬

```js
async fetch(endPoint, options = {}) {
// ...
}
```

- endPoint: μ”μ²­μ„ λ³΄λ‚Ό μ—”λ“ν¬μΈνΈμ κ²½λ΅
- options: μ¶”κ°€μ μΈ HTTP μ”μ²­ μµμ…μ„ μ„¤μ •ν•  μ μλ” κ°μ²΄ => κΈ°λ³Έκ°’μ€ λΉ κ°μ²΄.

## 3. HTTP μ”μ²­ λ³΄λ‚΄κΈ°

window.fetch ν•¨μλ¥Ό μ‚¬μ©ν•μ—¬ HTTP μ”μ²­μ„ λ³΄λƒ„.

```js
const response = await window.fetch(this.#baseURL + endPoint, {
  ...options,
  headers: {
    "Content-Type": "application/json",
    Authorization: "Bearer " + this.#storage.get(),
    ...options.headers
  }
});
```

- this.#baseURL + endPoint: μ”μ²­μ URLμ€ κΈ°λ³Έ URL(baseURL)κ³Ό μ—”λ“ν¬μΈνΈ(endPoint)λ¥Ό ν•©μΉ κ²ƒ
- options: κΈ°λ³Έ μ”μ²­ μµμ…κ³Ό μ‚¬μ©μ μ§€μ • μµμ…μ„ ν•©μΉ¨.
- headers: μ”μ²­ ν—¤λ”λ¥Ό μ„¤μ •. μ΄ λ¶€λ¶„μ—μ„λ” JSON ν•μ‹μ μ»¨ν…μΈ  νƒ€μ…κ³Ό μΈμ¦ ν† ν°μ„ ν—¤λ”μ— μ¶”κ°€.

## 4. μ‘λ‹µ μ²λ¦¬

HTTP μ‘λ‹µμ„ ν™•μΈν•κ³  μ²λ¦¬

```js
if (response.ok) {
  return response;
} else {
  const errorResponse = await response.json();
  throw new Error(
    `β›”οΈ HTTP Error ${response.status}: ${errorResponse.message}`
  );
}
```

- response.ok: HTTP μ‘λ‹µμ μƒνƒ μ½”λ“κ°€ μ„±κ³µ(200λ²λ€)μΈ κ²½μ°μ—λ” μ‘λ‹µ κ°μ²΄λ¥Ό λ°ν™
- κ·Έλ ‡μ§€ μ•μ€ κ²½μ°, μ—λ¬ μ‘λ‹µμ„ JSON ν•μ‹μΌλ΅ νμ‹±ν•κ³  μ—λ¬ λ©”μ‹μ§€λ¥Ό μ‚¬μ©ν•μ—¬ μμ™Έλ¥Ό λμ§

## 5. ν΄λμ¤λ΅ κµ¬ν„ν• μ΄μ 

μƒνƒ κ΄€λ¦¬: HTTP ν΄λΌμ΄μ–ΈνΈλ” μƒνƒλ¥Ό μ μ§€ν•΄μ•Ό ν•λ―€λ΅ ν΄λμ¤κ°€ μƒνƒλ¥Ό μ‰½κ² κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.
μ½”λ“ κµ¬μ΅°ν™”: ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ©΄ μ½”λ“λ¥Ό λ…Όλ¦¬μ μΌλ΅ κµ¬μ΅°ν™”ν•κ³  λ©”μ„λ“λ¥Ό μ‚¬μ©ν•μ—¬ μ‘μ—…μ„ λ¶„λ¦¬ν•  μ μμµλ‹λ‹¤.
κ°€λ…μ„±κ³Ό μ μ§€λ³΄μμ„±: μ½”λ“λ¥Ό μ½κΈ° μ‰½κ² λ§λ“¤κ³  μ μ§€λ³΄μλ¥Ό μ‰½κ² ν•  μ μμµλ‹λ‹¤.
